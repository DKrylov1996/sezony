"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={3524:e=>{e.exports=require("@prisma/client")},2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},4635:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>f,requestAsyncStorage:()=>x,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{POST:()=>d});var o=r(9303),i=r(8716),a=r(3131),s=r(7070),u=r(2023),l=r(3538),p=r(6446),c=r(5456);async function d(e){let t=await e.formData(),r=t.get("email")?.toString()||"",n=t.get("password")?.toString()||"",o=await l._.adminUser.findUnique({where:{email:r}});if(!o||!await (0,u.compare)(n,o.passwordHash))return s.NextResponse.redirect(new URL("/admin?error=1",(0,p.S)(e)));let i=await (0,c.kt)({id:o.id,email:o.email}),a=s.NextResponse.redirect(new URL("/admin/projects",(0,p.S)(e)));return a.cookies.set(c.sV,i,{httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:604800}),a}let m=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\kompik\\Documents\\VScode\\sezony\\src\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:x,staticGenerationAsyncStorage:g,serverHooks:h}=m,w="/api/auth/login/route";function f(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},5456:(e,t,r)=>{r.d(t,{Gg:()=>l,kt:()=>u,sV:()=>a,v1:()=>p});var n=r(1615),o=r(6091),i=r(6176);let a="sezony_session";function s(){let e=process.env.AUTH_SECRET;if(!e)throw Error("AUTH_SECRET is not set");return new TextEncoder().encode(e)}async function u(e){let t=s();return new o.N({email:e.email}).setProtectedHeader({alg:"HS256"}).setSubject(e.id).setIssuedAt().setExpirationTime("7d").sign(t)}async function l(){let e=(0,n.cookies)(),t=e.get(a)?.value;if(!t)return null;try{let{payload:e}=await (0,i._)(t,s());return{id:e.sub,email:e.email}}catch{return null}}async function p(){let e=await l();if(!e)throw Error("UNAUTHORIZED");return e}},3538:(e,t,r)=>{r.d(t,{_:()=>o});var n=r(3524);let o=global.prisma||new n.PrismaClient},6446:(e,t,r)=>{r.d(t,{S:()=>n});function n(e){let t=e.headers.get("x-forwarded-proto"),r=e.headers.get("x-forwarded-host")??e.headers.get("host"),n=t??e.nextUrl?.protocol??new URL(e.url??"http://localhost").protocol;return(n=n.replace(/:$/,""),r)?`${n}://${r}`:e.nextUrl?.origin??new URL(e.url??"http://localhost").origin}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,529,972,23],()=>r(4635));module.exports=n})();